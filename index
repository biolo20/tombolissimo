<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <title>TOMBOLISSIMA - Tombola di Natale</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --bg-main: #020617;
      --bg-surface: #020617;
      --accent-gold: #facc15;
      --accent-gold-soft: #fde68a;
      --accent-red: #b91c1c;
      --accent-green: #15803d;
      --text-main: #e5e7eb;
      --text-soft: #9ca3af;
      --border-soft: #1f2937;
      --radius-lg: 26px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background:
        radial-gradient(circle at top left, rgba(185, 28, 28, 0.22), transparent 55%),
        radial-gradient(circle at bottom right, rgba(22, 101, 52, 0.22), transparent 55%),
        radial-gradient(circle at top, #020617 0%, #020617 45%, #020617 100%);
      color: var(--text-main);
      padding: 20px;
    }

    .app {
      position: relative;
      display: flex;
      flex-direction: column;
      gap: 16px;
      background:
        radial-gradient(circle at top, rgba(15, 23, 42, 0.9), #020617 70%);
      border-radius: var(--radius-lg);
      padding: 20px 22px 24px;
      max-width: 1180px;
      width: 100%;
      box-shadow:
        0 0 0 1px rgba(15, 23, 42, 0.9),
        0 24px 80px rgba(0, 0, 0, 0.85);
      overflow: hidden;
    }

    /* Bordo interno discreto */
    .app::before {
      content: "";
      position: absolute;
      inset: 10px;
      border-radius: 20px;
      border: 1px solid rgba(15, 23, 42, 0.9);
      pointer-events: none;
    }

    /* Banner finale */
    .finished-banner {
      position: absolute;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      text-align: center;
      background: radial-gradient(circle at center, rgba(15, 23, 42, 0.96), rgba(15, 23, 42, 0.98));
      backdrop-filter: blur(4px);
      z-index: 5;
    }

    .finished-banner-inner {
      padding: 18px 26px;
      border-radius: 999px;
      border: 1px solid rgba(250, 204, 21, 0.8);
      background:
        linear-gradient(135deg, rgba(248, 250, 252, 0.04), rgba(15, 23, 42, 0.95));
      box-shadow:
        0 0 28px rgba(250, 204, 21, 0.55),
        0 0 46px rgba(34, 197, 94, 0.4);
      color: #fefce8;
      font-size: 1.1rem;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .finished-banner.show {
      display: flex;
      animation: fadeSlide 0.6s ease-out;
    }

    @keyframes fadeSlide {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* HEADER */
    .header {
      text-align: center;
      padding-bottom: 8px;
      border-bottom: 1px solid rgba(15, 23, 42, 0.9);
    }

    .title-row {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin-bottom: 4px;
    }

    .title-icon {
      font-size: 1.6rem;
    }

    .title-main {
      font-size: 2.3rem;
      font-weight: 900;
      letter-spacing: 0.28em;
      text-transform: uppercase;
      color: #fefce8;
      text-shadow:
        0 0 12px rgba(252, 211, 77, 0.65),
        0 0 26px rgba(234, 179, 8, 0.8);
    }

    .title-sub {
      font-size: 0.9rem;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: var(--text-soft);
    }

    .title-underline {
      margin: 10px auto 0;
      width: 180px;
      height: 3px;
      border-radius: 999px;
      background: linear-gradient(90deg, var(--accent-red), var(--accent-gold), var(--accent-green));
      box-shadow: 0 0 16px rgba(250, 204, 21, 0.55);
    }

    .body {
      display: flex;
      gap: 24px;
      margin-top: 6px;
    }

    /* TABELLONE */
    .board-wrapper {
      flex: 1.4;
      background:
        radial-gradient(circle at top, rgba(15, 23, 42, 0.9), #020617 80%);
      border-radius: 22px;
      padding: 18px 18px 20px;
      border: 1px solid rgba(31, 41, 55, 0.9);
      box-shadow:
        0 0 22px rgba(15, 23, 42, 1),
        inset 0 0 28px rgba(15, 23, 42, 1);
    }

    .board-title {
      text-align: center;
      margin-bottom: 10px;
      font-size: 0.95rem;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      color: var(--text-main);
    }

    .board-title span {
      color: var(--accent-green);
    }

    .board {
      display: grid;
      grid-template-columns: repeat(10, minmax(30px, 1fr));
      gap: 6px;
    }

    .cell {
      aspect-ratio: 1 / 1;
      border-radius: 12px;
      border: 1px solid var(--border-soft);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
      background:
        radial-gradient(circle at top, #020617 0%, #020617 60%, #020617 100%);
      color: #e5e7eb;
      box-shadow:
        inset 0 0 10px rgba(15, 23, 42, 1);
      transition:
        transform 0.18s ease,
        box-shadow 0.18s ease,
        background 0.18s ease,
        color 0.18s ease,
        border-color 0.18s ease,
        filter 0.18s ease;
    }

    .cell:hover {
      transform: translateY(-1px);
      filter: brightness(1.06);
      border-color: rgba(148, 163, 184, 0.7);
    }

    @keyframes cellPop {
      0%   { transform: scale(0.9); opacity: 0; }
      60%  { transform: scale(1.04); opacity: 1; }
      100% { transform: scale(1.0); }
    }

    .cell.extracted {
      background: linear-gradient(135deg, #fef3c7, var(--accent-gold-soft));
      color: #111827;
      font-weight: 700;
      border-color: #fbbf24;
      box-shadow:
        0 0 8px rgba(251, 191, 36, 0.6);
      transform: scale(1.0);
      animation: cellPop 0.18s ease-out;
    }

    /* PANNELLO DI CONTROLLO */
    .controls {
      flex: 0.9;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .panel {
      background:
        radial-gradient(circle at top, rgba(15, 23, 42, 0.9), #020617 80%);
      border-radius: 22px;
      padding: 18px 18px 20px;
      border: 1px solid rgba(31, 41, 55, 0.9);
      box-shadow:
        0 0 22px rgba(15, 23, 42, 1),
        inset 0 0 26px rgba(15, 23, 42, 1);
    }

    .panel h2 {
      font-size: 0.9rem;
      margin-bottom: 10px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: var(--text-soft);
    }

    .current-number-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 16px;
    }

    .spinner-wrapper {
      position: relative;
      width: 130px;
      height: 130px;
    }

    .spinner-ring {
      position: absolute;
      inset: 0;
      border-radius: 999px;
      border: 7px solid #020617;
      /* solo rosso e bianco alternati */
      border-top-color: #ffffff;
      border-right-color: #b91c1c;
      border-bottom-color: #ffffff;
      border-left-color: #b91c1c;
      box-shadow:
        0 0 14px rgba(248, 250, 252, 0.22),
        0 0 20px rgba(248, 250, 252, 0.35);
    }

    .spinner-ring.animate {
      animation: spin 0.65s linear infinite;
    }

    .current-number {
      position: absolute;
      inset: 14px;
      border-radius: 999px;
      background:
        radial-gradient(circle at top, #020617 0%, #020617 60%, #020617 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 3.1rem;
      font-weight: 900;
      letter-spacing: 0.06em;
      color: #f9fafb;
      text-shadow:
        0 0 12px rgba(15, 23, 42, 1),
        0 0 30px rgba(15, 23, 42, 0.9);
    }

    .status-text {
      font-size: 0.9rem;
      color: var(--text-main);
      text-align: center;
      min-height: 1.4em;
    }

    .button-wrapper {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 6px;
      width: 100%;
    }

    button {
      border: none;
      border-radius: 999px;
      padding: 12px 20px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      background: linear-gradient(135deg, var(--accent-red), var(--accent-gold));
      color: #111827;
      box-shadow:
        0 8px 22px rgba(185, 28, 28, 0.6),
        0 0 22px rgba(250, 204, 21, 0.6);
      transition:
        transform 0.14s ease,
        box-shadow 0.14s ease,
        filter 0.14s ease,
        opacity 0.14s ease;
      position: relative;
      overflow: hidden;
    }

    #draw-btn::before {
      content: "";
      position: absolute;
      inset: -40%;
      background: radial-gradient(circle at 0 0, rgba(255, 255, 255, 0.4), transparent 55%);
      transform: translateX(-130%);
      opacity: 0.9;
    }

    #draw-btn:hover::before {
      animation: sweep 0.6s ease-out;
    }

    @keyframes sweep {
      from { transform: translateX(-130%); }
      to   { transform: translateX(40%); }
    }

    button:hover:not(:disabled) {
      transform: translateY(-1px) scale(1.03);
      filter: brightness(1.05);
      box-shadow:
        0 12px 32px rgba(185, 28, 28, 0.75),
        0 0 28px rgba(250, 204, 21, 0.75);
    }

    button:active:not(:disabled) {
      transform: translateY(0) scale(0.97);
      box-shadow:
        0 4px 14px rgba(0, 0, 0, 0.6),
        0 0 18px rgba(250, 204, 21, 0.6);
    }

    button:disabled {
      opacity: 0.55;
      cursor: not-allowed;
      box-shadow: none;
    }

    .secondary-button {
      background: #020617;
      color: var(--text-main);
      box-shadow: none;
      border-radius: 999px;
      border: 1px dashed rgba(148, 163, 184, 0.6);
      padding: 8px 14px;
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
    }

    .secondary-button:hover:not(:disabled) {
      background: #020617;
      transform: none;
      box-shadow: 0 0 14px rgba(148, 163, 184, 0.35);
    }

    .info {
      font-size: 0.8rem;
      color: var(--text-soft);
      margin-top: 8px;
      text-align: center;
    }

    .stats {
      display: flex;
      justify-content: space-between;
      font-size: 0.85rem;
      color: var(--text-main);
      margin-top: 10px;
      width: 100%;
    }

    .stats span strong {
      color: var(--accent-gold);
    }

    /* STORICO ULTIMI NUMERI */
    .history {
      margin-top: 14px;
      width: 100%;
    }

    .history-title {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: var(--text-soft);
      margin-bottom: 6px;
      text-align: left;
    }

    .history-list {
      display: flex;
      justify-content: space-between;
      gap: 6px;
      width: 100%;
    }

    .history-item {
      flex: 1;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      padding: 6px 0;
      font-size: 0.9rem;
      text-align: center;
      background: radial-gradient(circle at top, #020617, #020617 60%);
      color: #f9fafb;
      box-shadow: inset 0 0 10px rgba(15, 23, 42, 1);
      transition: opacity 0.25s ease, transform 0.15s ease, box-shadow 0.15s ease;
    }

    .history-item.newest {
      background: linear-gradient(135deg, #b91c1c, #f97316);
      border-color: #fecaca;
      box-shadow: 0 0 12px rgba(248, 113, 113, 0.7);
    }

    @keyframes spin {
      from { transform: rotate(0deg); }
      to   { transform: rotate(360deg); }
    }

    /* RESPONSIVE */
    @media (max-width: 1000px) {
      .title-main {
        font-size: 2rem;
        letter-spacing: 0.24em;
      }
    }

    @media (max-width: 900px) {
      .app {
        padding: 18px 16px 22px;
      }

      .body {
        flex-direction: column;
      }

      .controls {
        flex-direction: row;
        align-items: stretch;
      }

      .controls .panel {
        flex: 1;
      }
    }

    @media (max-width: 700px) {
      .body {
        flex-direction: column;
      }

      .controls {
        flex-direction: column;
      }

      .board {
        grid-template-columns: repeat(9, minmax(26px, 1fr));
      }

      .title-main {
        font-size: 1.7rem;
        letter-spacing: 0.20em;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- Banner finale -->
    <div id="finished-banner" class="finished-banner">
      <div class="finished-banner-inner">
        <span>ðŸŽ‰</span>
        <span>Tutti i numeri sono stati estratti!</span>
        <span>ðŸŽ‰</span>
      </div>
    </div>

    <!-- HEADER -->
    <header class="header">
      <div class="title-row">
        <span class="title-icon">ðŸŽ„</span>
        <div class="title-main">TOMBOLISSIMA</div>
        <span class="title-icon">ðŸŽ„</span>
      </div>
      <div class="title-sub">tombola di natale</div>
      <div class="title-underline"></div>
    </header>

    <div class="body">
      <!-- TABELLONE -->
      <div class="board-wrapper">
        <div class="board-title">
          <span>Tombola</span> â€¢ Tabellone 1â€“90
        </div>
        <div id="board" class="board"></div>
      </div>

      <!-- PANNELLO DI CONTROLLO -->
      <div class="controls">
        <div class="panel">
          <h2>Estrazione</h2>
          <div class="current-number-container">
            <div class="spinner-wrapper">
              <div id="spinner" class="spinner-ring"></div>
              <div id="current-number" class="current-number">â€“</div>
            </div>
            <div id="status" class="status-text"></div>

            <div class="button-wrapper">
              <button id="draw-btn">Estrai</button>
              <button id="reset-btn" class="secondary-button">Reimposta tabellone</button>
            </div>

            <div class="stats">
              <span>Estratti: <strong id="drawn-count">0</strong> / 90</span>
              <span>Rimasti: <strong id="remaining-count">90</strong></span>
            </div>

            <div class="history">
              <div class="history-title">Ultimi numeri estratti</div>
              <div id="history-list" class="history-list">
                <!-- elementi creati da JS -->
              </div>
            </div>

            <p class="info">
              Premi <strong>Estrai</strong> per pescare un nuovo numero.
              La casella corrispondente nel tabellone si illuminerÃ  in automatico.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const boardEl = document.getElementById("board");
    const drawBtn = document.getElementById("draw-btn");
    const resetBtn = document.getElementById("reset-btn");
    const spinnerEl = document.getElementById("spinner");
    const currentNumberEl = document.getElementById("current-number");
    const statusEl = document.getElementById("status");
    const drawnCountEl = document.getElementById("drawn-count");
    const remainingCountEl = document.getElementById("remaining-count");
    const finishedBannerEl = document.getElementById("finished-banner");
    const historyListEl = document.getElementById("history-list");

    let remainingNumbers = [];
    let drawnNumbers = [];

    function createBoard() {
      boardEl.innerHTML = "";
      for (let i = 1; i <= 90; i++) {
        const cell = document.createElement("div");
        cell.className = "cell";
        cell.dataset.number = i;
        cell.textContent = i;
        boardEl.appendChild(cell);
      }
    }

    function resetGame() {
      remainingNumbers = Array.from({ length: 90 }, (_, i) => i + 1);
      drawnNumbers = [];
      document.querySelectorAll(".cell").forEach((cell) => {
        cell.classList.remove("extracted");
      });
      currentNumberEl.textContent = "â€“";
      statusEl.textContent = "";
      updateStats();
      updateHistory();
      drawBtn.disabled = false;
      drawBtn.textContent = "Estrai";
      finishedBannerEl.classList.remove("show");
    }

    function updateStats() {
      drawnCountEl.textContent = drawnNumbers.length;
      remainingCountEl.textContent = remainingNumbers.length;
    }

    function updateHistory() {
      historyListEl.innerHTML = "";
      if (drawnNumbers.length === 0) return;

      // Ultimi 5 numeri, il piÃ¹ recente per primo
      const lastFive = drawnNumbers.slice(-5).reverse();
      const opacities = [1, 0.85, 0.7, 0.55, 0.4];

      lastFive.forEach((num, index) => {
        const item = document.createElement("div");
        item.className = "history-item";
        if (index === 0) {
          item.classList.add("newest");
        }
        const o = opacities[index] !== undefined ? opacities[index] : opacities[opacities.length - 1];
        item.style.opacity = o.toString();
        item.textContent = num;
        historyListEl.appendChild(item);
      });
    }

    function showFinishedBanner() {
      finishedBannerEl.classList.add("show");
    }

    function drawNumber() {
      if (remainingNumbers.length === 0) {
        statusEl.textContent = "Tutti i numeri sono giÃ  stati estratti.";
        drawBtn.disabled = true;
        return;
      }

      drawBtn.disabled = true;
      statusEl.textContent = "Estrazione in corso...";
      spinnerEl.classList.add("animate");
      currentNumberEl.textContent = "?";

      const delay = 1200; // ms

      setTimeout(() => {
        const randomIndex = Math.floor(Math.random() * remainingNumbers.length);
        const number = remainingNumbers[randomIndex];

        remainingNumbers.splice(randomIndex, 1);
        drawnNumbers.push(number);

        spinnerEl.classList.remove("animate");

        currentNumberEl.textContent = number;
        statusEl.textContent = "Numero estratto!";

        const cell = boardEl.querySelector(`.cell[data-number="${number}"]`);
        if (cell) {
          cell.classList.add("extracted");
        }

        updateStats();
        updateHistory();

        if (remainingNumbers.length === 0) {
          statusEl.textContent = "Tutti i numeri sono stati estratti! ðŸŽ‰";
          drawBtn.textContent = "Finito";
          drawBtn.disabled = true;
          showFinishedBanner();
        } else {
          drawBtn.disabled = false;
        }
      }, delay);
    }

    createBoard();
    resetGame();

    drawBtn.addEventListener("click", drawNumber);
    resetBtn.addEventListener("click", resetGame);
  </script>
</body>
</html>
